#!/bin/sh
python ../main.py \
    --model 'SparseCodingCNN' \
    --task 'CIFAR10' \
    --competitiontype 'feature_inner_products' \
    --inhibitstrength 1.0 \
    --lambdas 0.1 \
    --sparse-layers -5 \
    --comp-syn-constraints 'colunitnorm,zerodiag,transposesymmetric' \
    --dt 0.15 \
    --channels 128 256 512 512 \
    --kernels 3 3 3 3 \
    --pools 'mmmm' \
    --strides 1 1 1 1 \
    --paddings 1 1 1 0 \
    --fc 10 \
    --optim 'sgd' \
    --mmt 0.9 \
    --lrs 0.25 0.15 0.1 0.08 0.05 \
    --lr-decay \
    --epochs 5 \
    --wds 3e-4 3e-4 3e-4 3e-4 3e-4 \
    --act 'my_hard_sig' \
    --todo 'train' \
    --betas 0.0 2.0 \
    --thirdphase \
    --T1 250 \
    --T2 250 \
    --mbs 128 \
    --loss 'mse' \
    --data-aug \
    --device 0 \
    --seed $1 \
    --save \
#    --load-path-convert results/EP/mse/2023-08-03/orig_mse_14-38-36_gpu0_120epochs
